name: Documentation

on:
  push:
    branches: [ main ]
    paths:
      - 'docs/**'
      - 'README.md'
      - 'CONTRIBUTING.md'
      - '.github/workflows/docs.yml'
  workflow_dispatch:

env:
  DOTNET_VERSION: '10.0.x'

jobs:
  build-docs:
    name: Build and Deploy Documentation
    runs-on: ubuntu-latest
    
    permissions:
      contents: write
      pages: write
      id-token: write
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Setup .NET
      uses: actions/setup-dotnet@v4
      with:
        dotnet-version: ${{ env.DOTNET_VERSION }}

    - name: Setup DocFX
      run: dotnet tool install -g docfx

    - name: Restore and Build projects
      run: |
        dotnet restore
        dotnet build --configuration Release --no-restore
      continue-on-error: false

    - name: Generate API documentation from XML comments
      run: |
        mkdir -p docs/api
        docfx metadata docs/docfx.json
      continue-on-error: false

    - name: Build documentation site with DocFX
      run: |
        docfx build docs/docfx.json
      continue-on-error: false

    - name: Copy markdown files
      run: |
        cp docs/*.md docs/_site/ 2>/dev/null || true
        cp README.md docs/_site/ 2>/dev/null || true
        cp CONTRIBUTING.md docs/_site/ 2>/dev/null || true

    - name: Create HTML wrappers for markdown files
      run: |
        for mdfile in docs/*.md; do
          if [ -f "$mdfile" ]; then
            basename=$(basename "$mdfile" .md)
            cat > "docs/_site/${basename}.html" <<'HTMLEOF'
        <!DOCTYPE html>
        <html lang="en" data-theme="light">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>DDAP Documentation</title>
            <style>
                :root[data-theme="light"] {
                    --bg-primary: #ffffff;
                    --bg-secondary: #f6f8fa;
                    --text-primary: #24292f;
                    --text-secondary: #57606a;
                    --text-tertiary: #6e7781;
                    --link-color: #0969da;
                    --link-hover: #0550ae;
                    --border-color: #d0d7de;
                    --code-bg: rgba(175,184,193,0.2);
                    --code-text: #1f2328;
                    --pre-bg: #2d2d2d;
                    --pre-text: #f8f8f2;
                    --header-bg: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    --shadow: rgba(0,0,0,0.1);
                }
                :root[data-theme="dark"] {
                    --bg-primary: #0d1117;
                    --bg-secondary: #010409;
                    --text-primary: #e6edf3;
                    --text-secondary: #8d96a0;
                    --text-tertiary: #7d8590;
                    --link-color: #4493f8;
                    --link-hover: #58a6ff;
                    --border-color: #30363d;
                    --code-bg: rgba(110,118,129,0.2);
                    --code-text: #e6edf3;
                    --pre-bg: #1c2128;
                    --pre-text: #e6edf3;
                    --header-bg: linear-gradient(135deg, #4a5fa8 0%, #5a3c72 100%);
                    --shadow: rgba(0,0,0,0.5);
                }
                :root[data-theme="high-contrast"] {
                    --bg-primary: #ffffff;
                    --bg-secondary: #f0f0f0;
                    --text-primary: #000000;
                    --text-secondary: #000000;
                    --text-tertiary: #1a1a1a;
                    --link-color: #0000ee;
                    --link-hover: #0000cc;
                    --border-color: #000000;
                    --code-bg: #e0e0e0;
                    --code-text: #000000;
                    --pre-bg: #000000;
                    --pre-text: #ffffff;
                    --header-bg: #000000;
                    --shadow: rgba(0,0,0,0.3);
                }
                * { box-sizing: border-box; }
                body { 
                    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
                    background: var(--bg-secondary);
                    color: var(--text-primary);
                    margin: 0;
                    padding: 0;
                    line-height: 1.6;
                }
                .header {
                    background: var(--header-bg);
                    color: white;
                    padding: 20px;
                    box-shadow: 0 2px 10px var(--shadow);
                }
                .header-content {
                    max-width: 1200px;
                    margin: 0 auto;
                    display: flex;
                    align-items: center;
                    justify-content: space-between;
                    flex-wrap: wrap;
                    gap: 15px;
                }
                .header h1 { margin: 0; font-size: 1.8em; }
                .nav-links { display: flex; align-items: center; gap: 15px; flex-wrap: wrap; }
                .nav-links a {
                    color: white;
                    text-decoration: none;
                    opacity: 0.9;
                    transition: opacity 0.2s;
                }
                .nav-links a:hover { opacity: 1; }
                .theme-selector {
                    display: flex;
                    gap: 8px;
                    align-items: center;
                    padding: 5px 10px;
                    background: rgba(255,255,255,0.1);
                    border-radius: 5px;
                }
                .theme-btn {
                    background: none;
                    border: 1px solid rgba(255,255,255,0.3);
                    color: white;
                    padding: 5px 10px;
                    border-radius: 3px;
                    cursor: pointer;
                    font-size: 0.85em;
                    transition: all 0.2s;
                }
                .theme-btn:hover { background: rgba(255,255,255,0.2); }
                .theme-btn.active {
                    background: rgba(255,255,255,0.3);
                    border-color: rgba(255,255,255,0.6);
                }
                .container {
                    max-width: 1200px;
                    margin: 40px auto;
                    padding: 0 20px;
                }
                .back-link {
                    display: inline-block;
                    margin-bottom: 20px;
                    color: var(--link-color);
                    text-decoration: none;
                }
                .back-link:hover {
                    text-decoration: underline;
                    color: var(--link-hover);
                }
                .markdown-body {
                    background: var(--bg-primary);
                    padding: 40px;
                    border-radius: 8px;
                    box-shadow: 0 2px 10px var(--shadow);
                    color: var(--text-primary);
                }
                .markdown-body h1, .markdown-body h2, .markdown-body h3,
                .markdown-body h4, .markdown-body h5, .markdown-body h6 {
                    color: var(--text-primary);
                    margin-top: 24px;
                    margin-bottom: 16px;
                    font-weight: 600;
                    line-height: 1.25;
                }
                .markdown-body h1 { font-size: 2em; border-bottom: 1px solid var(--border-color); padding-bottom: 0.3em; }
                .markdown-body h2 { font-size: 1.5em; border-bottom: 1px solid var(--border-color); padding-bottom: 0.3em; }
                .markdown-body h3 { font-size: 1.25em; }
                .markdown-body p, .markdown-body li, .markdown-body td, .markdown-body th {
                    color: var(--text-primary);
                }
                .markdown-body a {
                    color: var(--link-color);
                    text-decoration: none;
                }
                .markdown-body a:hover {
                    text-decoration: underline;
                    color: var(--link-hover);
                }
                .markdown-body code {
                    background: var(--code-bg);
                    color: var(--code-text);
                    padding: 0.2em 0.4em;
                    border-radius: 3px;
                    font-family: 'Courier New', Consolas, monospace;
                    font-size: 0.85em;
                }
                .markdown-body pre {
                    background: var(--pre-bg);
                    color: var(--pre-text);
                    padding: 16px;
                    border-radius: 6px;
                    overflow-x: auto;
                    line-height: 1.45;
                }
                .markdown-body pre code {
                    background: none;
                    color: inherit;
                    padding: 0;
                }
                .markdown-body blockquote {
                    color: var(--text-secondary);
                    border-left: 4px solid var(--border-color);
                    padding-left: 16px;
                    margin: 16px 0;
                }
                .markdown-body ul, .markdown-body ol { padding-left: 2em; }
                .markdown-body table {
                    border-collapse: collapse;
                    width: 100%;
                    margin: 16px 0;
                }
                .markdown-body th, .markdown-body td {
                    border: 1px solid var(--border-color);
                    padding: 8px 12px;
                }
                .markdown-body th {
                    background: var(--bg-secondary);
                    font-weight: 600;
                }
                .markdown-body img { max-width: 100%; height: auto; }
                .markdown-body hr {
                    border: none;
                    border-top: 1px solid var(--border-color);
                    margin: 24px 0;
                }
                .markdown-body strong, .markdown-body b {
                    color: var(--text-primary);
                    font-weight: 600;
                }
            </style>
        </head>
        <body>
            <div class="header">
                <div class="header-content">
                    <h1>üöÄ DDAP Documentation</h1>
                    <div class="nav-links">
                        <a href="index.html">Home</a>
                        <a href="api/">API Reference</a>
                        <a href="https://github.com/schivei/ddap">GitHub</a>
                        <div class="theme-selector">
                            <button class="theme-btn" data-theme="light" title="Light theme">‚òÄÔ∏è</button>
                            <button class="theme-btn" data-theme="dark" title="Dark theme">üåô</button>
                            <button class="theme-btn" data-theme="high-contrast" title="High contrast theme">‚óê</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container">
                <a href="index.html" class="back-link">‚Üê Back to Documentation</a>
                <div class="markdown-body" id="content">Loading...</div>
            </div>
            <script>
                // Theme management
                function setTheme(theme) {
                    document.documentElement.setAttribute('data-theme', theme);
                    localStorage.setItem('ddap-theme', theme);
                    document.querySelectorAll('.theme-btn').forEach(btn => {
                        btn.classList.toggle('active', btn.getAttribute('data-theme') === theme);
                    });
                }
                
                // Initialize theme
                const savedTheme = localStorage.getItem('ddap-theme');
                const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                const systemPrefersContrast = window.matchMedia('(prefers-contrast: more)').matches;
                const initialTheme = savedTheme || (systemPrefersContrast ? 'high-contrast' : (systemPrefersDark ? 'dark' : 'light'));
                setTheme(initialTheme);
                
                // Theme button listeners
                document.querySelectorAll('.theme-btn').forEach(btn => {
                    btn.addEventListener('click', () => setTheme(btn.getAttribute('data-theme')));
                });
                
                // Listen to system theme changes
                window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
                    if (!localStorage.getItem('ddap-theme')) {
                        setTheme(e.matches ? 'dark' : 'light');
                    }
                });
                
                // Simple markdown parser
                function parseMarkdown(md) {
                    // Split into lines for better processing
                    const lines = md.split('\n');
                    let html = '';
                    let inList = false;
                    let inCodeBlock = false;
                    let codeBlock = '';
                    
                    for (let i = 0; i < lines.length; i++) {
                        let line = lines[i];
                        
                        // Handle code blocks
                        if (line.trim().startsWith('```')) {
                            if (!inCodeBlock) {
                                inCodeBlock = true;
                                codeBlock = '';
                            } else {
                                html += '<pre><code>' + codeBlock + '</code></pre>';
                                inCodeBlock = false;
                            }
                            continue;
                        }
                        
                        if (inCodeBlock) {
                            codeBlock += line + '\n';
                            continue;
                        }
                        
                        // Handle lists
                        if (line.match(/^[\*\-] /) || line.match(/^\d+\. /)) {
                            if (!inList) {
                                html += '<ul>';
                                inList = true;
                            }
                            line = line.replace(/^[\*\-] (.*)$/, '<li>$1</li>');
                            line = line.replace(/^\d+\. (.*)$/, '<li>$1</li>');
                            html += line;
                            continue;
                        } else if (inList) {
                            html += '</ul>';
                            inList = false;
                        }
                        
                        // Headers
                        if (line.match(/^### /)) {
                            html += line.replace(/^### (.*)$/, '<h3>$1</h3>');
                        } else if (line.match(/^## /)) {
                            html += line.replace(/^## (.*)$/, '<h2>$1</h2>');
                        } else if (line.match(/^# /)) {
                            html += line.replace(/^# (.*)$/, '<h1>$1</h1>');
                        } else if (line.match(/^---$/)) {
                            html += '<hr>';
                        } else if (line.match(/^> /)) {
                            html += line.replace(/^> (.*)$/, '<blockquote>$1</blockquote>');
                        } else if (line.trim() === '') {
                            html += '</p><p>';
                        } else {
                            html += line + ' ';
                        }
                    }
                    
                    if (inList) html += '</ul>';
                    
                    // Wrap in paragraphs
                    html = '<p>' + html + '</p>';
                    
                    // Inline formatting
                    html = html.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                    html = html.replace(/\*([^*]+)\*/g, '<em>$1</em>');
                    html = html.replace(/`([^`]+)`/g, '<code>$1</code>');
                    html = html.replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2">$1</a>');
                    
                    // Clean up
                    html = html.replace(/<p><\/p>/g, '');
                    html = html.replace(/<p>(<h[1-6]>)/g, '$1').replace(/(<\/h[1-6]>)<\/p>/g, '$1');
                    html = html.replace(/<p>(<pre>)/g, '$1').replace(/(<\/pre>)<\/p>/g, '$1');
                    html = html.replace(/<p>(<ul>)/g, '$1').replace(/(<\/ul>)<\/p>/g, '$1');
                    html = html.replace(/<p>(<hr>)<\/p>/g, '$1');
                    html = html.replace(/<p>(<blockquote>)/g, '$1').replace(/(<\/blockquote>)<\/p>/g, '$1');
                    
                    return html;
                }
                
                // Load markdown content
                fetch('MDFILE.md')
                    .then(r => r.ok ? r.text() : Promise.reject())
                    .then(md => { document.getElementById('content').innerHTML = parseMarkdown(md); })
                    .catch(() => { document.getElementById('content').innerHTML = '<h1>Error</h1><p>Could not load document.</p>'; });
            </script>
        </body>
        </html>
        HTMLEOF
            sed -i "s/MDFILE/${basename}/g" "docs/_site/${basename}.html"
          fi
        done

    - name: Create index page
      run: |
        cat > docs/_site/index.html <<'INDEXEOF'
        <!DOCTYPE html>
        <html lang="en" data-theme="light">
        <head>
            <title>DDAP Documentation - Dynamic Data API Provider</title>
            <meta charset="utf-8">
            <meta name="viewport" content="width=device-width, initial-scale=1">
            <meta name="description" content="DDAP automatically generates REST, gRPC, and GraphQL APIs from your database schema">
            <style>
                :root[data-theme="light"] {
                    --bg-page: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    --bg-container: #ffffff;
                    --bg-header: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    --bg-card: #f8f9fa;
                    --bg-footer: #f8f9fa;
                    --text-primary: #24292f;
                    --text-secondary: #57606a;
                    --text-footer: #666;
                    --text-white: #ffffff;
                    --accent-color: #667eea;
                    --accent-hover: #764ba2;
                    --link-color: #667eea;
                    --shadow: rgba(0,0,0,0.2);
                    --shadow-card: rgba(0,0,0,0.1);
                    --code-bg: #f4f4f4;
                    --pre-bg: #2d2d2d;
                    --pre-text: #f8f8f2;
                }
                :root[data-theme="dark"] {
                    --bg-page: linear-gradient(135deg, #1a1f36 0%, #1e1533 100%);
                    --bg-container: #0d1117;
                    --bg-header: linear-gradient(135deg, #4a5fa8 0%, #5a3c72 100%);
                    --bg-card: #161b22;
                    --bg-footer: #161b22;
                    --text-primary: #e6edf3;
                    --text-secondary: #8d96a0;
                    --text-footer: #8d96a0;
                    --text-white: #ffffff;
                    --accent-color: #58a6ff;
                    --accent-hover: #79c0ff;
                    --link-color: #58a6ff;
                    --shadow: rgba(0,0,0,0.6);
                    --shadow-card: rgba(0,0,0,0.4);
                    --code-bg: #1c2128;
                    --pre-bg: #1c2128;
                    --pre-text: #e6edf3;
                }
                :root[data-theme="high-contrast"] {
                    --bg-page: #000000;
                    --bg-container: #ffffff;
                    --bg-header: #000000;
                    --bg-card: #f0f0f0;
                    --bg-footer: #f0f0f0;
                    --text-primary: #000000;
                    --text-secondary: #000000;
                    --text-footer: #000000;
                    --text-white: #ffffff;
                    --accent-color: #0000ee;
                    --accent-hover: #0000cc;
                    --link-color: #0000ee;
                    --shadow: rgba(0,0,0,0.5);
                    --shadow-card: rgba(0,0,0,0.3);
                    --code-bg: #e0e0e0;
                    --pre-bg: #000000;
                    --pre-text: #ffffff;
                }
                
                * { box-sizing: border-box; margin: 0; padding: 0; }
                body { 
                    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
                    line-height: 1.6;
                    color: var(--text-primary);
                    background: var(--bg-page);
                    min-height: 100vh;
                    padding: 20px;
                    transition: background 0.3s ease, color 0.3s ease;
                }
                .container {
                    max-width: 900px;
                    margin: 0 auto;
                    background: var(--bg-container);
                    border-radius: 10px;
                    box-shadow: 0 10px 40px var(--shadow);
                    overflow: hidden;
                }
                .header {
                    background: var(--bg-header);
                    color: var(--text-white);
                    padding: 40px;
                    text-align: center;
                    position: relative;
                }
                .header h1 { font-size: 2.5em; margin-bottom: 10px; }
                .header p { font-size: 1.2em; opacity: 0.9; }
                .theme-selector {
                    position: absolute;
                    top: 15px;
                    right: 15px;
                    display: flex;
                    gap: 8px;
                    background: rgba(255,255,255,0.1);
                    padding: 5px;
                    border-radius: 5px;
                }
                .theme-btn {
                    background: none;
                    border: 1px solid rgba(255,255,255,0.3);
                    color: var(--text-white);
                    padding: 8px 12px;
                    border-radius: 3px;
                    cursor: pointer;
                    font-size: 1.1em;
                    transition: all 0.2s;
                }
                .theme-btn:hover { background: rgba(255,255,255,0.2); }
                .theme-btn.active {
                    background: rgba(255,255,255,0.3);
                    border-color: rgba(255,255,255,0.6);
                }
                .content { padding: 40px; background: var(--bg-container); }
                .nav-section {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                    gap: 20px;
                    margin: 30px 0;
                }
                .nav-card {
                    padding: 25px;
                    background: var(--bg-card);
                    border-radius: 8px;
                    border-left: 4px solid var(--accent-color);
                    transition: transform 0.2s, box-shadow 0.2s;
                }
                .nav-card:hover {
                    transform: translateY(-5px);
                    box-shadow: 0 5px 20px var(--shadow-card);
                }
                .nav-card h3 { color: var(--accent-color); margin-bottom: 10px; font-size: 1.3em; }
                .nav-card p { color: var(--text-secondary); margin-bottom: 15px; }
                .nav-card a {
                    display: inline-block;
                    padding: 8px 16px;
                    background: var(--accent-color);
                    color: var(--text-white);
                    text-decoration: none;
                    border-radius: 5px;
                    font-size: 0.9em;
                    transition: background 0.2s;
                }
                .nav-card a:hover { background: var(--accent-hover); }
                .section { margin: 30px 0; }
                .section h2 {
                    color: var(--accent-color);
                    margin-bottom: 15px;
                    padding-bottom: 10px;
                    border-bottom: 2px solid var(--bg-card);
                }
                .features {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                    gap: 15px;
                    margin: 20px 0;
                }
                .feature {
                    padding: 15px;
                    background: var(--bg-card);
                    border-radius: 5px;
                    text-align: center;
                }
                .feature strong { color: var(--accent-color); display: block; margin-bottom: 5px; }
                .feature p { color: var(--text-secondary); }
                code {
                    background: var(--code-bg);
                    color: var(--text-primary);
                    padding: 2px 6px;
                    border-radius: 3px;
                    font-family: 'Courier New', monospace;
                    font-size: 0.9em;
                }
                pre {
                    background: var(--pre-bg);
                    color: var(--pre-text);
                    padding: 20px;
                    border-radius: 5px;
                    overflow-x: auto;
                    margin: 15px 0;
                }
                pre code { background: none; color: inherit; padding: 0; }
                .badges { margin: 20px 0; text-align: center; }
                .badges img { margin: 0 5px; }
                footer {
                    text-align: center;
                    padding: 20px;
                    background: var(--bg-footer);
                    color: var(--text-footer);
                    font-size: 0.9em;
                }
                ul { list-style: none; padding: 0; }
                li {
                    padding: 10px;
                    background: var(--bg-card);
                    margin: 5px 0;
                    border-radius: 5px;
                }
                li a {
                    color: var(--link-color);
                    text-decoration: none;
                }
                li a:hover { text-decoration: underline; }
            </style>
        </head>
        <body>
            <div class="container">
                <div class="header">
                    <div class="theme-selector">
                        <button class="theme-btn" data-theme="light" title="Light theme">‚òÄÔ∏è</button>
                        <button class="theme-btn" data-theme="dark" title="Dark theme">üåô</button>
                        <button class="theme-btn" data-theme="high-contrast" title="High contrast theme">‚óê</button>
                    </div>
                    <h1>üöÄ DDAP</h1>
                    <p>Dynamic Data API Provider for .NET</p>
                </div>
                
                <div class="content">
                    <div class="badges">
                        <a href="https://github.com/schivei/ddap/actions"><img src="https://github.com/schivei/ddap/actions/workflows/build.yml/badge.svg" alt="Build Status"></a>
                        <a href="https://www.nuget.org/packages?q=ddap"><img src="https://img.shields.io/nuget/v/Ddap.Core.svg" alt="NuGet"></a>
                        <a href="https://github.com/schivei/ddap/blob/main/LICENSE"><img src="https://img.shields.io/github/license/schivei/ddap" alt="License"></a>
                    </div>

                    <div class="section">
                        <h2>üìö Documentation Guides</h2>
                        <div class="nav-section">
                            <div class="nav-card">
                                <h3>üéØ Get Started</h3>
                                <p>Learn the basics and create your first DDAP API in minutes</p>
                                <a href="get-started.html">Start Tutorial ‚Üí</a>
                            </div>
                            <div class="nav-card">
                                <h3>üìñ API Reference</h3>
                                <p>Complete API documentation generated from XML comments</p>
                                <a href="api/">Browse API ‚Üí</a>
                            </div>
                            <div class="nav-card">
                                <h3>üèóÔ∏è Architecture</h3>
                                <p>Understand DDAP's design, components, and how everything works together</p>
                                <a href="architecture.html">View Architecture ‚Üí</a>
                            </div>
                            <div class="nav-card">
                                <h3>üîß Advanced Usage</h3>
                                <p>Extensibility, custom endpoints, and advanced patterns</p>
                                <a href="advanced.html">Advanced Guide ‚Üí</a>
                            </div>
                            <div class="nav-card">
                                <h3>üóÑÔ∏è Database Providers</h3>
                                <p>SQL Server, MySQL, PostgreSQL, and Entity Framework support</p>
                                <a href="database-providers.html">Database Docs ‚Üí</a>
                            </div>
                            <div class="nav-card">
                                <h3>üåê API Providers</h3>
                                <p>REST, gRPC, and GraphQL API implementation details</p>
                                <a href="api-providers.html">API Docs ‚Üí</a>
                            </div>
                            <div class="nav-card">
                                <h3>üêõ Troubleshooting</h3>
                                <p>Common issues, solutions, and debugging tips</p>
                                <a href="troubleshooting.html">Get Help ‚Üí</a>
                            </div>
                        </div>
                    </div>

                    <div class="section">
                        <h2>‚ú® Features</h2>
                        <div class="features">
                            <div class="feature">
                                <strong>üöÄ Auto API Generation</strong>
                                <p>Load database schema and create endpoints automatically</p>
                            </div>
                            <div class="feature">
                                <strong>üóÑÔ∏è Multi-Database</strong>
                                <p>SQL Server, MySQL, PostgreSQL</p>
                            </div>
                            <div class="feature">
                                <strong>üåê Multi-Protocol</strong>
                                <p>REST, gRPC, GraphQL</p>
                            </div>
                            <div class="feature">
                                <strong>üìã Content Negotiation</strong>
                                <p>JSON, XML, YAML support</p>
                            </div>
                            <div class="feature">
                                <strong>üîß Extensible</strong>
                                <p>Partial classes for customization</p>
                            </div>
                            <div class="feature">
                                <strong>üì¶ Modular</strong>
                                <p>Separate libraries per provider</p>
                            </div>
                        </div>
                    </div>

                    <div class="section">
                        <h2>‚ö° Quick Start</h2>
                        <p>Install the packages:</p>
                        <pre><code>dotnet add package Ddap.Core
dotnet add package Ddap.Data.Dapper.SqlServer
dotnet add package Ddap.Rest
dotnet add package Ddap.GraphQL</code></pre>
                        
                        <p>Configure in Program.cs:</p>
                        <pre><code>builder.Services
    .AddDdap(options => {
        options.ConnectionString = "Server=localhost;Database=MyDb;...";
    })
    .AddSqlServerDapper()
    .AddRest()
    .AddGraphQL();</code></pre>
                    </div>

                    <div class="section">
                        <h2>üîó Additional Resources</h2>
                        <ul>
                            <li><a href="https://github.com/schivei/ddap">üìÇ GitHub Repository</a></li>
                            <li><a href="https://github.com/schivei/ddap/tree/main/examples">üí° Example Projects</a></li>
                            <li><a href="https://www.nuget.org/packages?q=ddap">üì¶ NuGet Packages</a></li>
                            <li><a href="README.html">üìñ README</a></li>
                            <li><a href="CONTRIBUTING.html">ü§ù Contributing Guide</a></li>
                        </ul>
                    </div>
                </div>
                
                <footer>
                    <p>DDAP - Dynamic Data API Provider | MIT License | ¬© 2026</p>
                    <p>Built with ‚ù§Ô∏è for the .NET community</p>
                </footer>
            </div>
            
            <script>
                function setTheme(theme) {
                    document.documentElement.setAttribute('data-theme', theme);
                    localStorage.setItem('ddap-theme', theme);
                    document.querySelectorAll('.theme-btn').forEach(btn => {
                        btn.classList.toggle('active', btn.getAttribute('data-theme') === theme);
                    });
                }
                
                const savedTheme = localStorage.getItem('ddap-theme');
                const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                const systemPrefersContrast = window.matchMedia('(prefers-contrast: more)').matches;
                const initialTheme = savedTheme || (systemPrefersContrast ? 'high-contrast' : (systemPrefersDark ? 'dark' : 'light'));
                setTheme(initialTheme);
                
                document.querySelectorAll('.theme-btn').forEach(btn => {
                    btn.addEventListener('click', () => setTheme(btn.getAttribute('data-theme')));
                });
                
                window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
                    if (!localStorage.getItem('ddap-theme')) {
                        setTheme(e.matches ? 'dark' : 'light');
                    }
                });
                
                window.matchMedia('(prefers-contrast: more)').addEventListener('change', (e) => {
                    if (!localStorage.getItem('ddap-theme')) {
                        setTheme(e.matches ? 'high-contrast' : 'light');
                    }
                });
            </script>
        </body>
        </html>
        INDEXEOF

    - name: Upload to GitHub Pages
      uses: actions/upload-pages-artifact@v3
      if: github.event_name == 'push' && github.ref == 'refs/heads/main'
      with:
        path: docs/_site
      continue-on-error: true

    - name: Deploy to GitHub Pages
      id: deployment
      if: github.event_name == 'push' && github.ref == 'refs/heads/main'
      uses: actions/deploy-pages@v4
      continue-on-error: true
    
    - name: Summary
      run: |
        echo "## Documentation Build Summary" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "‚úÖ Documentation files created successfully" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "### Generated Files:" >> $GITHUB_STEP_SUMMARY
        echo "- üìÑ index.html (main page)" >> $GITHUB_STEP_SUMMARY
        echo "- üìö get-started.md" >> $GITHUB_STEP_SUMMARY
        echo "- üèóÔ∏è architecture.md" >> $GITHUB_STEP_SUMMARY
        echo "- üîß advanced.md" >> $GITHUB_STEP_SUMMARY
        echo "- üóÑÔ∏è database-providers.md" >> $GITHUB_STEP_SUMMARY
        echo "- üåê api-providers.md" >> $GITHUB_STEP_SUMMARY
        echo "- üêõ troubleshooting.md" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        if [ "${{ steps.deployment.outcome }}" == "success" ]; then
          echo "üöÄ **Deployed to GitHub Pages successfully!**" >> $GITHUB_STEP_SUMMARY
        else
          echo "‚ö†Ô∏è GitHub Pages deployment skipped or failed (make sure GitHub Pages is enabled in repository settings)" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "To enable: https://github.com/schivei/ddap/settings/pages" >> $GITHUB_STEP_SUMMARY
        fi
